<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <template id="product_grid_las" name="Products grid Las Rías" inherit_id="website_sale.products">
        <xpath expr="//div[@id='products_grid']//table" position="replace">
            <t t-set="pageName" t-value="'shoppage'"/>
            <table class="table table-striped table-condensed">
                <thead class="hidden-xs hidden-sm">
                    <tr>
                        <th class='td-product_name'>Reference</th>
                        <th class='td-product_name'>Product</th>
                        <th class='td-qty'>Quantity</th>
                        <th class="text-right td-price">Unit Price</th>
                        <th class="text-right">Stock</th>
                        <th class="text-right">Image</th>
                        <th class="text-right">Barcode</th>
                        <th class="text-right">Options</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-set="website_sale_order" t-value="website.sale_get_order()" />
                    <t t-set="products_in_cart" t-value="website.get_products_in_cart(website_sale_order)" />
                    <t t-foreach="bins" t-as="tr_product">
                        <t t-foreach="tr_product" t-as="td_product">
                            <t t-if="td_product">
                                <t t-set="product" t-value="td_product['product']" />
                                <t t-if="len(product.product_variant_ids) == 1">
                                    <t t-set="class_allowed" t-value="website.is_allowed_purchase(product.product_variant_id.id)" />
                                    <tr t-att-product-id="product['id']" t-att-variant-id="false" t-att-class="class_allowed['status']">
                                        <td class='td-product_name'>
                                            <span t-field="product.default_code" />
                                        </td>
                                        <td class='td-product_name'>
                                            <div>
                                                <a t-attf-href="/shop/product/#{ slug(product) }">
                                                    <strong t-esc="product.with_context(display_default_code=False).display_name" />
                                                </a>
                                                <t t-if="class_allowed['status'] == 'warning'">
                                                    <i class="fa fa-info-circle info-button-campaign" aria-hidden="true" data-toggle="tooltip" data-placement="top"
                                                     data-trigger="click" title="Este producto pertenece a una campaña activa, te recomendamos añadirlo a un pedido de campaña"/>
                                                </t>
                                            </div>
                                            <t t-if="product.product_variant_id.id in products_in_cart">
                                                <a href='#' class='js_delete_product hidden-xs no-decoration'> <small><i class='fa fa-trash-o'/> Remove</small></a>
                                            </t>
                                            <t t-else="">
                                                <a href='#' class='js_delete_product hidden-xs no-decoration hidden'> <small><i class='fa fa-trash-o'/> Remove</small></a>
                                            </t>
                                        </td>
                                        <td class="text-right td-qty">
                                            <div class="css_quantity input-group oe_website_spinner">
                                                <a t-attf-href="#" class="mb8 input-group-addon js_add_cart_json hidden-xs">
                                                    <i class="fa fa-minus"/>
                                                </a>
                                                <t t-set="current_qty" t-value="website.get_current_cart_qty(website_sale_order, product.product_variant_id.id) if product.product_variant_id.id in products_in_cart else {'line_id': False, 'product_uom_qty': 0}" />                                            
                                                <input type="number" class="js_quantity form-control quantity" t-att-line-id="current_qty['line_id']" t-att-data-product-id="product.product_variant_id.id" t-att-value="current_qty['product_uom_qty']" placeholder="0"/>
                                                <a t-attf-href="#" class="mb8 input-group-addon float_left js_add_cart_json hidden-xs">
                                                    <i class="fa fa-plus"/>
                                                </a>
                                            </div>
                                        </td>
                                        <td class="text-right td-price" name="price">
                                            <span t-field="product.list_price" style="white-space: nowrap;" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}" groups="sale.group_show_price_subtotal" />
                                        </td>
                                        <td class="text-right">
                                            <!-- <span t-field="product.qty_available"/> -->
                                        </td>
                                        <td class="text-right td-img">
                                            <a t-if="product.image" href="#" class="image-call">
                                                <img src="/theme_rias_multi_cart/static/img/ui/image-icon.gif"/>
                                            </a>
                                        </td>
                                        <td class="text-right">
                                            <a t-if="product.barcode" href="#" class="barcode-call">
                                                <img src="/theme_rias_multi_cart/static/img/ui/barcode-icon.jpg"/>
                                            </a>
                                        </td>
                                        <td class="text-right">
                                            <div class="col-md-6">
                                                <a title="Ir o crear pedido de campaña." t-if="class_allowed['status'] == 'warning' and class_allowed['campaign_id']" t-attf-href="/my/campaigns/select/#{ class_allowed['campaign_id'] }" class="btn btn-primary">
                                                    <i class="fa fa-shopping-cart"/>
                                                </a>
                                            </div>
                                            <!-- <div class="col-md-6">
                                                <a title="Añadir a pedido de campaña." t-if="class_allowed['status'] == 'warning' and class_allowed['campaign_id']" t-att-data-campaign-id="class_allowed['campaign_id']" href="#" class="btn btn-primary campaign-call">
                                                    <i class="fa fa-plus"></i>
                                                </a>
                                            </div> -->
                                        </td>
                                    </tr>
                                </t>
                                <t t-if="len(product.product_variant_ids) &gt; 1">
                                    <t t-foreach="product.product_variant_ids" t-as="variant_id">
                                        <t t-set="class_allowed" t-value="website.is_allowed_purchase(variant_id.id)" />
                                        <tr t-att-product-id="product['id']" t-att-variant-id="variant_id.id" t-att-class="class_allowed['status']">
                                            <t t-set="current_qty" t-value="website.get_current_cart_qty(website_sale_order, variant_id.id) if variant_id.id in products_in_cart else {'line_id': False, 'product_uom_qty': 0}" />
                                            <td class='td-product_name'>
                                                <span t-field="variant_id.default_code"/>
                                            </td>
                                            <td class='td-product_name'>
                                                <div>
                                                    <a t-attf-href="/shop/product/#{ slug(product) }">
                                                        <strong class="oe_inline" name="attr_name" t-esc="variant_id.name_get()[0][1]"/>
                                                    </a>
                                                    <t t-if="class_allowed['status'] == 'warning'">
                                                        <i class="fa fa-info-circle info-button-campaign" aria-hidden="true" data-toggle="tooltip" data-placement="top" data-trigger="click" title="Este producto pertenece a una campaña activa, te recomendamos añadirlo a un pedido de campaña"/>
                                                    </t>
                                                </div>
                                                <t t-if="current_qty['product_uom_qty'] &gt; 0">
                                                    <a href='#' class='js_delete_product hidden-xs no-decoration'> <small><i class='fa fa-trash-o'/> Remove</small></a>
                                                </t>
                                                <t t-else="">
                                                    <a href='#' class='js_delete_product hidden-xs no-decoration hidden'> <small><i class='fa fa-trash-o'/> Remove</small></a>
                                                </t>
                                            </td>
                                            <td class="text-right td-qty">
                                                <div class="css_quantity input-group oe_website_spinner">
                                                    <a t-attf-href="#" class="mb8 input-group-addon js_add_cart_json hidden-xs">
                                                        <i class="fa fa-minus"/>
                                                    </a>
                                                    <input type="number" class="js_quantity form-control quantity" t-att-line-id="current_qty['line_id']" t-att-data-product-id="variant_id.id" t-att-value="current_qty['product_uom_qty']" placeholder="0"/>
                                                    <a t-attf-href="#" class="mb8 input-group-addon float_left js_add_cart_json hidden-xs">
                                                        <i class="fa fa-plus"/>
                                                    </a>
                                                </div>
                                            </td>
                                            <td class="text-right td-price" name="price">
                                                <span t-field="variant_id.list_price" style="white-space: nowrap;" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}" groups="sale.group_show_price_subtotal" />
                                            </td>
                                            <td class="text-right">
                                                <!-- <span t-field="variant_id.qty_available"/> -->
                                            </td>
                                            <td class="text-right td-img">
                                                <a t-if="variant_id.image or product.image" href="#" class="image-call">
                                                    <img src="/theme_rias_multi_cart/static/img/ui/image-icon.gif"/>
                                                </a>
                                            </td>
                                            <td class="text-right">
                                                <a t-if="variant_id.barcode or product.barcode" href="#" class="barcode-call">
                                                    <img src="/theme_rias_multi_cart/static/img/ui/barcode-icon.jpg"/>
                                                </a>
                                            </td>
                                            <td class="text-right">
                                                <div class="col-md-6">
                                                    <a title="Ir o crear pedido de campaña." t-if="class_allowed['status'] == 'warning' and class_allowed['campaign_id']" t-attf-href="/my/campaigns/select/#{ class_allowed['campaign_id'] }" class="btn btn-primary">
                                                        <i class="fa fa-shopping-cart"/>
                                                    </a>
                                                </div>
                                                <!-- <div class="col-md-6">
                                                    <a title="Añadir a pedido de campaña." t-if="class_allowed['status'] == 'warning' and class_allowed['campaign_id']" t-att-data-campaign-id="class_allowed['campaign_id']" href="#" class="btn btn-primary campaign-call">
                                                        <i class="fa fa-plus"></i>
                                                    </a>
                                                </div> -->
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </t>
                        </t>
                    </t>
                </tbody>
            </table>
        </xpath>

        <xpath expr="//div[@id='wrap']/div[hasclass('oe_website_sale')]" position="inside">
            <div id="rpc_modal"/>
        </xpath>

    </template>

    <template id="website_sale_products_attributes_las" name="Product Attribute's Filters Las Rías" inherit_id="website_sale.products_attributes">
        <xpath expr="//div[@id='products_grid_before']/form/ul" position="inside">
            <t t-foreach="bins" t-as="tr_product">
                <t t-set="providers" t-value="website.get_providers_in_list(tr_product)"/>
                <li t-if="providers">
                    <div>
                        <strong>Providers</strong>
                    </div>
                    <select class="form-control" name="provider">
                        <option value="" />
                        <t t-foreach="providers" t-as="provider">
                            <option t-att-value="provider.id" t-esc="provider.name" t-att-selected="provider.id in providers_set"/>
                        </t>
                    </select>
                </li>
            </t>
        </xpath>
    </template>

    <template id="las_shop_product_page" name="Shop Product Page Las Rías" inherit_id="website_sale.product">
        <xpath expr="//div[@id='wrap']" position="inside">
            <t t-set="pageName" t-value="'productpage'"/>
            <t t-set="allowed_purchase" t-value="website.is_allowed_purchase(product.product_variant_id.id)"/>
            <span id="allowed_purchase" t-esc="allowed_purchase['status']" style="display: none;"/>
        </xpath>
        <xpath expr="//form[hasclass('js_add_cart_variants')]" position="before">
            <div id="purchase_msg" class="mt8 mb8"/>
        </xpath>
    </template>

    <template id="las_product_wishlist" name="Wishlist Page Las Rías" inherit_id="website_sale_wishlist.product_wishlist">
        <xpath expr="//div[@id='wrap']" position="inside">
            <t t-set="pageName" t-value="'wishlistpage'"/>
        </xpath>
        <xpath expr="//tr/td[2]" position="inside">
            <t t-set="allowed_purchase" t-value="website.is_allowed_purchase(wish.product_id.id)"/>
            <span class="allowed_purchase" t-esc="allowed_purchase['status']" style="display: none;"/>
            <div class="purchase_msg"/>
        </xpath>
        <xpath expr="//tr/td[4]" position="inside">
            <a title="Ir o crear pedido de campaña." t-if="allowed_purchase['status'] == 'warning' and allowed_purchase['campaign_id']" t-attf-href="/my/campaigns/select/#{ allowed_purchase['campaign_id'] }" class="btn btn-primary">
                <i class="fa fa-shopping-cart"/>
            </a>
        </xpath>

    </template>

</odoo>